{"version":3,"sources":["Storage.js","Menu/Menu.js","Editor/util.js","Editor/Agenda.js","Editor/Stats.js","CheatSheet/CheatSheet.js","Editor/popup.js","Editor/TodoPlayer.js","Editor/indicators.js","Editor/decorations.js","Editor/commands.js","Editor/setup.js","Editor/Editor.js","App.js","serviceWorker.js","index.js"],"names":["LOCAL_STORAGE_KEY","instance","Storage","_this","this","Object","classCallCheck","addNewNote","id","getNextNoteId","setState","notes","concat","toConsumableArray","state","content","meta","title","tags","created_at","Date","updated_at","deleted_at","selectedNote","selectNote","find","n","Error","updateNote","note","map","objectSpread","deleteNote","restoreNote","permanentlyDeleteNote","_this$state","remainingNotes","filter","handlers","window","localStorage","getItem","JSON","parse","length","getSelectedNote","createClass","key","value","f","_this2","push","fn","newState","setItem","stringify","forEach","h","Math","max","apply","_this$state2","result","getActiveNotes","sort","a","b","tag","Menu","props","possibleConstructorReturn","getPrototypeOf","call","handleToggleHidden","isHidden","handleSearch","e","search","target","unsubscribe","store","subscribe","forceUpdate","selected","activeNotes","inactiveNotes","getInactiveNotes","filterFn","toLowerCase","includes","react_default","createElement","className","onClick","type","placeholder","onChange","stopPropagation","entries","getNotesByTagsAndDate","_ref","_ref2","slicedToArray","React","Component","formatDate","date","d","month","getMonth","day","getDate","year","getFullYear","join","getDaysInMonthByWeeks","days","UTC","setDate","arguments","weeks","currentWeek","getDay","maxLen","w","unshift","getZeroBasedNum","num","monthNumToName","msToDuration","ms","m","s","round","normalizeDuration","parseDurationMatch","match","slice","Boolean","reduce","item","parseInt","floor","durationToStr","dateRegEx","Agenda","groups","todos","today","forToday","dateMatch","noHour","withHour","_a$dateMatch$slice","_a$dateMatch$slice2","hoursA","minutesA","_b$dateMatch$slice","_b$dateMatch$slice2","processTodos","prevTime","i","_item$dateMatch$slice","_item$dateMatch$slice2","hours","minutes","atTime","toTime","duration","spaceTime","Fragment","defaultChecked","done","toggle","text","Stats","notDone","CheatSheet","popup","document","classList","add","innerHTML","querySelector","addEventListener","hidePopup","titleNode","contentNode","footerNode","onHideCallbacks","showPopup","_ref$centered","centered","_ref$actions","actions","onHide","parentNode","body","appendChild","isValidElement","ReactDOM","render","remove","removeChild","unmountComponentAtNode","splice","cb","TodoPlayer","_React$Component","handleTogglePause","paused","componentDidMount","componentWillUnmount","time","handleStart","automatic","current","handleNextItem","data","nextItem","nextTime","finished","inherits","_timer","setInterval","bind","clearInterval","currentTime","currentItem","currentDuration","_this$props","onFinish","_this$state3","isNoDurationItem","style","textAlign","disabled","TODOIndicator","view","dom","preventDefault","next","action","dataset","fullTodoList","nextElementSibling","parsedNodes","clone","cloneNode","Array","from","children","c","contains","innerText","replace","TodoPlayer_TodoPlayer","checkbox","click","reverse","pos","posAtDOM","doc","nodeAt","tr","deleteRange","nodeSize","dispatch","DurationWidget","getPos","popupProps","interval","prevText","insertText","keys","k","OpenCloseDecorations","code","WholeNodeDecorations","tableRow","_heading","RepeatableDecorations","quote","bullet","ordered","todo","Decorations","bold","italic","highlight","underline","striketrough","hr","url","explication","_counter","_checkbox","_proportion","DecorationsWidgets","decos","currentNode","resolve","node","nodeBefore","nodeAfter","Decoration","widget","index","zIndex","position","checked","test","textContent","input","currentDate","Pikaday","field","trigger","firstDay","defaultDate","onSelect","inline","class","contenteditable","getCounterWidgets","_","nodeName","excludedNodes","excludedInTableRow","getDecorations","openClose","descendants","name","isText","isTableRow","regex","exec","href","closing","opening","nodesBetween","p","lang","source","hljs","getLanguage","DecorationSet","create","min","Infinity","decorations","Plugin","init","decorationsSet","docChanged","getState","selectHeader","prop","_state$selection3","selection","$from","to","same","sharedDepth","proseNode","before","nodeDOM","scrollIntoView","block","behavior","setSelection","Selection","near","tagName","selectNextHeader","_len","args","_key","selectPrevHeader","_len2","_key2","schema","Schema","nodes","paragraph","group","parseDOM","toDOM","hard_break","selectable","plugins","rules","InputRule","start","end","construct","split","week","replaceWith","parsed","chrono","insert","parseDate","inputRules","history","dropCursor","gapCursor","keymap","Mod-z","undo","Shift-Mod-z","redo","Mod-i","selectParentNode","Shift-Enter","baseKeymap","Ctrl-Enter","Tab","_state$selection2","domNodes","prev","previousElementSibling","_getFormattedTable","rows","selectedRow","selectedChar","isLineRow","row","dataRows","trim","separatorRowsIdxs","maxCellsNum","r","table","extraEmptyCells","repeat","_loop","maxWidth","str","toLength","padStr","undefined","fromLength","fromStart","fromEnd","ceil","padBothToLength","outputTable","lineRow","selectedCell","resultCellsLength","nextSelectedRow","nextSelectedCell","getFormattedTable","indexOf","_getFormattedTable2","RegExp","posInCell","TextSelection","Enter","_state$selection","$to","NodeSelection","isBlock","parentOffset","canSplit","parent","atEnd","size","deleteSelection","deflt","depth","contentMatchAt","indexAfter","defaultType","types","can","mapping","canReplace","setNodeMarkup","values","delete","navigator","platform","Mod-Enter","Mod-ArrowDown","Mod-ArrowUp","Ctrl-y","Ctrl-ArrowDown","Ctrl-ArrowUp","Editor","showEditor","helpShown","agendaShown","statsShown","toggleHelp","toggleStats","toggleAgenda","_createEditorView","element","elm","_editorState","EditorState","fromJSON","_editorView","EditorView","dispatchTransaction","tx","updateState","toJSON","getTitle","getTags","keyCode","querySelectorAll","contentEditable","destroy","heading","lastChild","el","t","focus","CheatSheet_CheatSheet","hideEdditor","renderMenu","getTodos","renderHelp","ref","display","App","Menu_Menu_Menu","src_Editor_Editor","location","hostname","src_App_0","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.b6cd6afd.chunk.js","sourcesContent":["const LOCAL_STORAGE_KEY = \"__prose-editor-state__\";\n\n// TODO: store each note individually\n// TODO: throttle writes\n// TODO: S3 for key-value storage of files\n// TODO: S3 for authentication\n\nexport class Storage {\n  constructor() {\n    this.handlers = [];\n    this.state = window.localStorage.getItem(LOCAL_STORAGE_KEY)\n      ? JSON.parse(window.localStorage.getItem(LOCAL_STORAGE_KEY))\n      : {\n          notes: [],\n          selectedNote: null\n        };\n\n    if (this.state.notes.length === 0) {\n      this.addNewNote();\n    }\n\n    if (!this.state.selectedNote || !this.getSelectedNote()) {\n      this.selectNote(this.state.notes[0].id);\n    }\n  }\n\n  subscribe(f) {\n    this.handlers.push(f);\n    return () => {\n      this.handlers = this.handlers.filter(fn => fn !== f);\n    };\n  }\n\n  setState(state) {\n    const newState = {\n      ...this.state,\n      ...state\n    };\n\n    this.state = newState;\n    window.localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(newState));\n    this.handlers.forEach(h => h());\n  }\n\n  // ===========================================================================\n  // Selectors\n\n  getActiveNotes() {\n    return this.state.notes.filter(n => !n.deleted_at);\n  }\n\n  getInactiveNotes() {\n    return this.state.notes.filter(n => !!n.deleted_at);\n  }\n\n  getNextNoteId() {\n    return Math.max(...this.state.notes.map(n => n.id), 0) + 1;\n  }\n\n  getSelectedNote() {\n    const { selectedNote, notes } = this.state;\n    return selectedNote && notes.find(n => n.id === selectedNote);\n  }\n\n  getNotesByTagsAndDate() {\n    const result = {};\n\n    this.getActiveNotes()\n      .sort((a, b) => a.updated_at - b.updated_at)\n      .forEach(note => {\n        note.meta.tags.forEach(tag => {\n          if (!result[tag]) result[tag] = [];\n          result[tag].push(note);\n        });\n      });\n\n    return result;\n  }\n\n  // ===========================================================================\n  // Mutations\n\n  addNewNote = () => {\n    const id = this.getNextNoteId();\n    this.setState({\n      notes: [\n        ...this.state.notes,\n        {\n          id,\n          content: null,\n          meta: {\n            title: null,\n            tags: []\n          },\n          created_at: new Date(),\n          updated_at: new Date(),\n          deleted_at: null\n        }\n      ],\n      selectedNote: id\n    });\n  };\n\n  selectNote = id => {\n    if (this.state.notes.find(n => n.id === id)) {\n      this.setState({ selectedNote: id });\n    } else {\n      throw new Error(`Cannot find note with id: ${id}`);\n    }\n  };\n\n  updateNote = note => {\n    this.setState({\n      notes: this.state.notes.map(n => {\n        if (n.id !== note.id) {\n          return n;\n        }\n\n        return {\n          ...n,\n          ...note,\n          updated_at: new Date()\n        };\n      })\n    });\n  };\n\n  deleteNote = note => {\n    this.updateNote({\n      ...note,\n      deleted_at: new Date()\n    });\n  };\n\n  restoreNote = note => {\n    this.updateNote({\n      ...note,\n      deleted_at: null\n    });\n  };\n\n  permanentlyDeleteNote = note => {\n    const { notes, selectedNote } = this.state;\n    const remainingNotes = notes.filter(n => n !== note);\n    this.setState({\n      notes: remainingNotes,\n      selectedNote:\n        selectedNote === note.id ? remainingNotes[0].id : selectedNote\n    });\n  };\n}\n\nconst instance = new Storage();\nexport default instance;\n","import React from \"react\";\nimport store from \"../Storage\";\nimport \"./Menu.css\";\n\nexport default class Menu extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isHidden: false,\n      search: \"\"\n    };\n  }\n\n  handleToggleHidden = () => {\n    this.setState({ isHidden: !this.state.isHidden });\n  };\n\n  handleSearch = e => {\n    debugger;\n    this.setState({ search: e.target.value });\n  };\n\n  componentDidMount() {\n    this.unsubscribe = store.subscribe(() => this.forceUpdate());\n  }\n\n  componentWillUnmount() {\n    this.unsubscribe();\n  }\n\n  render() {\n    const { isHidden, search } = this.state;\n    const selected = store.getSelectedNote();\n\n    let activeNotes = store.getActiveNotes();\n    let inactiveNotes = store.getInactiveNotes();\n\n    if (search) {\n      const filterFn = n =>\n        n.meta.title.toLowerCase().includes(search.toLowerCase());\n      activeNotes = activeNotes.filter(filterFn);\n      inactiveNotes = inactiveNotes.filter(filterFn);\n    }\n\n    return isHidden ? (\n      <section className=\"MenuTrigger\" onClick={this.handleToggleHidden}>\n        ⤇\n      </section>\n    ) : (\n      <section className=\"Menu\">\n        <button onClick={() => store.addNewNote()}>+</button>\n        <button onClick={this.handleToggleHidden}>Hide</button>\n        <hr />\n        <input\n          type=\"text\"\n          placeholder=\"Search...\"\n          value={search}\n          onChange={this.handleSearch}\n        />\n        <hr />\n        <h3 className=\"Menu--header\">Notes</h3>\n        <ul>\n          {activeNotes.map(n => (\n            <li\n              key={n.id}\n              onClick={() => store.selectNote(n.id)}\n              className={`Menu--item${n === selected ? \" active\" : \"\"}`}\n            >\n              {n.meta.title || \"--\"}\n              <button\n                onClick={e => {\n                  e.stopPropagation();\n                  store.deleteNote(n);\n                }}\n              >\n                X\n              </button>\n            </li>\n          ))}\n        </ul>\n        <h3 className=\"Menu--header\">Archive</h3>\n        <ul>\n          {inactiveNotes.map(n => (\n            <li\n              key={n.id}\n              onClick={() => store.selectNote(n.id)}\n              className={`Menu--item${n === selected ? \" active\" : \"\"}`}\n            >\n              {n.meta.title || \"--\"}\n              <button\n                onClick={e => {\n                  e.stopPropagation();\n                  store.permanentlyDeleteNote(n);\n                }}\n              >\n                X\n              </button>\n              <button\n                onClick={e => {\n                  e.stopPropagation();\n                  store.restoreNote(n);\n                }}\n              >\n                ^\n              </button>\n            </li>\n          ))}\n        </ul>\n        <h3 className=\"Menu--header\">Tags</h3>\n        <ul>\n          {Object.entries(store.getNotesByTagsAndDate()).map(([tag, notes]) => (\n            <li>\n              #{tag} ({notes.length})\n            </li>\n          ))}\n        </ul>\n      </section>\n    );\n  }\n}\n","export const isToday = someDate => {\n  const today = new Date();\n  return (\n    someDate.getDate() == today.getDate() &&\n    someDate.getMonth() == today.getMonth() &&\n    someDate.getFullYear() == today.getFullYear()\n  );\n};\n\nexport function formatDate(date) {\n  let d = new Date(date),\n    month = \"\" + (d.getMonth() + 1),\n    day = \"\" + d.getDate(),\n    year = d.getFullYear();\n\n  if (month.length < 2) month = \"0\" + month;\n  if (day.length < 2) day = \"0\" + day;\n\n  return [year, month, day].join(\"-\");\n}\n\nexport function getDaysInMonth(month, year) {\n  const date = new Date(Date.UTC(year, month, 1));\n  const days = [];\n  while (date.getMonth() === month) {\n    days.push(new Date(date));\n    date.setDate(date.getDate() + 1);\n  }\n  return days;\n}\n\nexport function getDaysInMonthByWeeks(...args) {\n  const days = getDaysInMonth(...args);\n  const weeks = [];\n\n  let prevDay = null;\n  let currentWeek = 0;\n\n  days.forEach(day => {\n    if (!weeks[currentWeek]) weeks[currentWeek] = [];\n    weeks[currentWeek].push(day);\n\n    if (day.getDay() === 0) {\n      currentWeek++;\n    }\n  });\n  const maxLen = Math.max(...weeks.map(w => w.length));\n\n  while (weeks[0].length !== maxLen) {\n    weeks[0].unshift(null);\n  }\n\n  while (weeks[weeks.length - 1].length !== maxLen) {\n    weeks[weeks.length - 1].push(null);\n  }\n\n  return weeks;\n}\n\nexport function getZeroBasedNum(num) {\n  return num < 10 ? `0${num}` : num;\n}\n\nexport const monthNumToName = [\n  \"January\",\n  \"February\",\n  \"March\",\n  \"April\",\n  \"May\",\n  \"June\",\n  \"July\",\n  \"August\",\n  \"September\",\n  \"October\",\n  \"November\",\n  \"December\"\n];\n\n// =============================================================================\n// Duration\n\nexport function msToDuration(ms) {\n  const d = {\n    h: 0,\n    m: 0,\n    s: Math.round(ms / 1000)\n  };\n  normalizeDuration(d);\n  return d;\n}\n\nexport function parseDuration(str) {\n  return parseDurationMatch(str.match(/\\b(\\d\\d?[hms])(\\d\\d?[ms])?(\\d\\d?s)?\\b/));\n}\n\nexport function parseDurationMatch(match) {\n  return match\n    .slice(1)\n    .filter(Boolean)\n    .reduce(\n      (result, item) => {\n        result[item[item.length - 1]] += parseInt(item, 10) * 1;\n        return result;\n      },\n      {\n        h: 0,\n        m: 0,\n        s: 0\n      }\n    );\n}\n\nexport function normalizeDuration(d) {\n  if (d.s >= 60) {\n    d.m += Math.floor(d.s / 60);\n    d.s = d.s % 60;\n  }\n\n  if (d.m >= 60) {\n    d.h += Math.floor(d.m / 60);\n    d.m = d.m % 60;\n  }\n}\n\nexport function durationToStr(d) {\n  return (\n    `${d.h ? d.h + \"h\" : \"\"}${d.m ? d.m + \"m\" : \"\"}${d.s ? d.s + \"s\" : \"\"}` ||\n    \"0s\"\n  );\n}\n","import React from \"react\";\nimport {\n  parseDuration,\n  normalizeDuration,\n  formatDate,\n  getZeroBasedNum,\n  durationToStr\n} from \"./util\";\n\nconst dateRegEx = /(\\d\\d\\d\\d)-(\\d\\d)-(\\d\\d)(:?\\s(\\d\\d):(\\d\\d))?/;\nconst durationRegEx = /\\b(\\d\\d?[hms])(\\d\\d?[ms])?(\\d\\d?s)?\\b/;\n\nfunction processTodos(todos) {\n  const today = formatDate(new Date());\n  const forToday = todos\n    .filter(item => item.date && item.date.includes(today))\n    .map(item => ({\n      ...item,\n      dateMatch: item.date.match(dateRegEx)\n    }));\n\n  if (forToday.length === 0) {\n    return null;\n  }\n\n  const noHour = forToday.filter(item => {\n    const timeData = item.dateMatch[4];\n    return !timeData;\n  });\n\n  const withHour = forToday\n    .filter(item => !!item.dateMatch[4])\n    .sort((a, b) => {\n      const [hoursA, minutesA] = a.dateMatch.slice(5);\n      const [hoursB, minutesB] = b.dateMatch.slice(5);\n      return hoursA * 60 + minutesA * 1 - (hoursB * 60 + minutesB * 1);\n    });\n\n  return { withHour, noHour };\n}\n\nexport default function Agenda({ todos }) {\n  const groups = processTodos(todos);\n\n  if (!groups) {\n    return (\n      <div className=\"Editor--agenda\">\n        <h3>Agenda</h3>\n        ----\n      </div>\n    );\n  }\n  const { withHour, noHour } = groups;\n\n  let prevTime = \"00:00\";\n\n  return (\n    <div className=\"Editor--agenda\">\n      <h3>Agenda</h3>\n      <ul>\n        {withHour.map((item, i) => {\n          const [hours, minutes] = item.dateMatch.slice(5);\n          const atTime = `${hours}:${minutes}`;\n\n          let toTime = \"\";\n          if (item.duration) {\n            const d = parseDuration(item.duration);\n\n            d.h += hours * 1;\n            d.m += minutes * 1;\n\n            normalizeDuration(d);\n\n            toTime = `${getZeroBasedNum(d.h)}:${getZeroBasedNum(d.m)}`;\n          }\n\n          let spaceTime = null;\n          if (prevTime !== atTime) {\n            spaceTime = (\n              <li key={prevTime}>\n                <b>\n                  [{prevTime}-{atTime}]\n                </b>\n                : ---------------------\n              </li>\n            );\n          }\n          prevTime = toTime || atTime;\n          return (\n            <>\n              {spaceTime}\n              <li key={i}>\n                <b>\n                  [{atTime}\n                  {toTime ? `-${toTime}` : \"\"}]\n                </b>{\" \"}\n                <input\n                  type=\"checkbox\"\n                  defaultChecked={item.done}\n                  onClick={item.toggle}\n                />\n                {item.text}\n              </li>\n            </>\n          );\n        })}\n        {prevTime !== \"23:59\" && (\n          <li key=\"last\">\n            <b>[{prevTime}-23:59]</b>: ---------------------\n          </li>\n        )}\n      </ul>\n\n      <h3>Task for the day</h3>\n      <ul>\n        {noHour.map((item, i) => (\n          <li key={i}>\n            <input\n              type=\"checkbox\"\n              defaultChecked={item.done}\n              onClick={item.toggle}\n            />\n            {item.text}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { formatDate } from \"./util\";\n\nexport default function Stats({ todos }) {\n  const notDone = todos.filter(item => !item.done);\n  const today = formatDate(new Date());\n\n  return (\n    <div className=\"Editor--stats\">\n      <ul>\n        <li>\n          You have <b>{notDone.length}</b> of {todos.length} items to do.\n        </li>\n        <li>\n          You have{\" \"}\n          <b>\n            {\n              notDone.filter(item => item.date && item.date.includes(today))\n                .length\n            }\n          </b>{\" \"}\n          items to do today.\n        </li>\n      </ul>\n    </div>\n  );\n}\n","import React, { useState } from \"react\";\n\nimport \"./CheatSheet.css\";\n\nexport default function CheatSheet() {\n  return (\n    <div className=\"CheatSheet\">\n      <button onClick={() => {}}>X</button>\n      <ul>\n        <li># Heading 1</li>\n        <li>## Heading 2</li>\n        <li>### Heading 3</li>\n        <li>--- line separator</li>\n      </ul>\n      <ul>\n        <li>#tag</li>\n        <li>*Bold*</li>\n        <li>/Italic/</li>\n        <li>_Underline_</li>\n        <li>-Striketrough-</li>\n        <li>`highlight`</li>\n        <li>http://somelink.com/</li>\n      </ul>\n      <ul>\n        <li>* list</li>\n        <li>1. Ordered list</li>\n        <li>- Todo list</li>\n        <li>~Striketrough~</li>\n      </ul>\n      <ul>\n        <li>{\"<today>\"}</li>\n      </ul>\n      <ul>\n        <li>Counter [2]</li>\n        <li>Checkbox [-]</li>\n        <li>Quantity [1/10]</li>\n        <li>Timer [10m20s]</li>\n        <li>Date [01/20/2019]</li>\n      </ul>\n      <ul>\n        <li>\n          ```\n          <br />\n          comment\n          <br />\n          ```\n          <br />\n        </li>\n        <li>\n          ===\n          <br />\n          |--------|------------|--------|\n          <br />\n          | *Name* | *Email* | *Date* |<br />\n          |--------|------------|--------|\n          <br />\n          | ivo | ivo@abv.bg | |<br />\n          |--------|------------|--------|\n          <br />\n          <br />\n          ===\n          <br />\n        </li>\n      </ul>\n    </div>\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nconst popup = document.createElement(\"div\");\npopup.classList.add(\"popup\");\npopup.innerHTML = `\n  <div class=\"content\">\n    <header>\n      <h2>Popup</h2>\n      <button class=\"close\">close</button>\n    </header>\n    <section>\n      some text\n    </section>\n    <footer></footer>\n  </div>\n`;\npopup.querySelector(\".close\").addEventListener(\"click\", hidePopup);\n\nconst titleNode = popup.querySelector(\"h2\");\nconst contentNode = popup.querySelector(\"section\");\nconst footerNode = popup.querySelector(\"footer\");\nconst onHideCallbacks = [];\n\nexport function showPopup({\n  title,\n  content,\n  centered = false, // Weather or not content is centered.\n  actions = [],\n  onHide\n}) {\n  if (!popup.parentNode) document.body.appendChild(popup);\n\n  titleNode.innerHTML = title || \"\";\n\n  contentNode.innerHTML = \"\";\n  if (React.isValidElement(content)) {\n    ReactDOM.render(content, contentNode);\n  } else {\n    contentNode.innerHTML = content || \"\";\n  }\n\n  if (centered) {\n    contentNode.classList.add(\"centered\");\n  } else {\n    contentNode.classList.remove(\"centered\");\n  }\n\n  if (onHide) onHideCallbacks.push(onHide);\n\n  footerNode.innerHTML = \"\";\n  actions.forEach(({ text, fn }) => {\n    const n = document.createElement(\"button\");\n    n.innerHTML = text;\n    n.addEventListener(\"click\", fn);\n    footerNode.appendChild(n);\n  });\n}\n\nexport function hidePopup() {\n  if (popup.parentNode) popup.parentNode.removeChild(popup);\n  ReactDOM.unmountComponentAtNode(contentNode);\n  onHideCallbacks.splice(0).forEach(cb => cb());\n}\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { msToDuration, durationToStr } from \"./util\";\n\n// TODO: Adds checked and actual duration\n// TODO: automatic playing\n// TODO: write stats (for v2)\n\nexport class TodoPlayer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      time: new Date(),\n      data: [],\n      current: -1,\n      finished: false,\n      automatic: false,\n      paused: false\n    };\n  }\n\n  componentDidMount() {\n    this._timer = setInterval(this.forceUpdate.bind(this), 1000);\n  }\n\n  componentWillUnmount() {\n    clearInterval(this._timer);\n  }\n\n  componentDidUpdate() {\n    const { todos } = this.props;\n    const { time, current, automatic, finished } = this.state;\n\n    if (finished) return;\n    if (!automatic) return;\n\n    const currentTime = new Date();\n    const currentItem = todos[current];\n    const currentDuration = durationToStr(msToDuration(currentTime - time));\n\n    if (currentItem.duration === currentDuration) {\n      this.handleNextItem(true);\n    }\n  }\n\n  handleTogglePause = () => {\n    const { paused } = this.state;\n    if (paused) {\n      this.componentDidMount();\n    } else {\n      this.componentWillUnmount();\n    }\n    this.setState({\n      paused: !paused,\n      ...(paused\n        ? {\n            time: new Date()\n          }\n        : {})\n    });\n  };\n\n  handleStart = automatic => {\n    this.setState({\n      automatic,\n      current: 0,\n      time: new Date()\n    });\n  };\n\n  handleNextItem = done => {\n    const { todos } = this.props;\n    const { current, data, time } = this.state;\n\n    const nextItem = current + 1;\n    const nextTime = new Date();\n\n    this.setState({\n      time: nextTime,\n      data: [\n        ...data,\n        {\n          done,\n          time: nextTime - time\n        }\n      ],\n      current: nextItem,\n      finished: nextItem === todos.length\n    });\n  };\n\n  getCurrentItem() {\n    return this.props.todos[this.state.current];\n  }\n\n  render() {\n    const { todos, onFinish } = this.props;\n    const { current, data, time, finished, automatic, paused } = this.state;\n\n    const currentTime = new Date();\n    const currentItem = todos[current];\n    const currentDuration = durationToStr(msToDuration(currentTime - time));\n\n    const isNoDurationItem = todos.find(item => !item.duration);\n\n    if (finished) {\n      return (\n        <div>\n          {data.filter(d => d.done).length} / {data.length} items done.\n          <button onClick={() => onFinish(data)}>Close</button>\n        </div>\n      );\n    }\n\n    if (!currentItem) {\n      return (\n        <div style={{ textAlign: \"left\" }}>\n          <p>\n            <button onClick={() => this.handleStart(false)}>Play Manual</button>{\" \"}\n            Manually switch tasks.\n          </p>\n\n          <br />\n          <br />\n          <p>\n            <button\n              onClick={() => this.handleStart(true)}\n              disabled={isNoDurationItem}\n            >\n              Play Automatic\n            </button>{\" \"}\n            Automatically switch task when its duration is over.{\" \"}\n            <i>\n              Every task should have duration in order to play automatically.\n            </i>\n          </p>\n        </div>\n      );\n    }\n\n    return (\n      <div>\n        <div className=\"TodoPlayer--text\">{currentItem.text}</div>\n        <div className=\"TodoPlayer--time\">\n          {currentDuration}\n          {currentItem.duration && ` / ${currentItem.duration}`}\n        </div>\n        <div className=\"TodoPlayer--footer\">\n          {automatic ? (\n            <>\n              <button onClick={this.handleTogglePause}>\n                {paused ? \"Resume\" : \"Pause\"}\n              </button>\n            </>\n          ) : (\n            <>\n              <button onClick={() => this.handleNextItem(false)}>Skip</button>\n              <button onClick={() => this.handleNextItem(true)}>Done</button>\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nTodoPlayer.propTypes = {\n  todos: PropTypes.arrayOf(\n    PropTypes.shape({\n      text: PropTypes.string.isRequired,\n      date: PropTypes.string.isRequired,\n      duration: PropTypes.string.isRequired\n    }).isRequired\n  ),\n  onFinish: PropTypes.func.isRequired\n};\n","import React from \"react\";\n\nimport { NodeSelection } from \"prosemirror-state\";\nimport { showPopup, hidePopup } from \"./popup\";\nimport { durationToStr, normalizeDuration, parseDurationMatch } from \"./util\";\nimport { TodoPlayer } from \"./TodoPlayer\";\n\nexport const TODOIndicator = view => {\n  const dom = document.createElement(\"div\");\n  dom.classList.add(\"indicator\");\n  dom.classList.add(\"todo-indicator\");\n  dom.innerHTML = `\n    <button class=\"trigger\">\n      ...\n    </button>\n    <div class=\"options\">\n      <button data-action=\"start\">Start</button>\n      <button data-action=\"reset\">Reset</button>\n      <button data-action=\"delete_completed\">Delete Completed</button>\n      <button data-action=\"delete_unfinished\">Delete Unfinished</button>\n      <button data-action=\"copy\">Copy list</button>\n    </div>\n  `;\n\n  dom.addEventListener(\"click\", e => {\n    e.preventDefault();\n    const node = e.target;\n    const action = node.dataset.action;\n\n    const fullTodoList = [dom.parentNode];\n\n    let next;\n    while (\n      (next = fullTodoList[fullTodoList.length - 1]) &&\n      (next = next.nextElementSibling) &&\n      !!next.querySelector(\".todo\")\n    ) {\n      fullTodoList.push(next);\n    }\n\n    switch (action) {\n      case \"start\": {\n        const parsedNodes = fullTodoList.map(n => {\n          const date = n.querySelector(\".date\");\n          const duration = n.querySelector(\".duration\");\n\n          const clone = n.cloneNode(true);\n          Array.from(clone.children)\n            .filter(c => c.classList.contains(\"ProseMirror-widget\"))\n            .forEach(c => c.parentNode.removeChild(c));\n\n          return {\n            text: clone.innerText.replace(/^(\\-|\\+)\\s/, \"\"),\n            date: date && date.innerText,\n            duration: duration && duration.innerText\n          };\n        });\n\n        const onFinish = data => {\n          data.forEach(({ done, time }, i) => {\n            const node = fullTodoList[i];\n            const checkbox = node.querySelector(\n              \"input[type=checkbox]:not(:checked)\"\n            );\n\n            if (done) {\n              checkbox.click();\n            }\n          });\n          hidePopup();\n        };\n        showPopup({\n          content: <TodoPlayer todos={parsedNodes} onFinish={onFinish} />,\n          centered: true\n        });\n\n        return;\n      }\n\n      case \"reset\": {\n        fullTodoList\n          .map(item => item.querySelector(\"input[type=checkbox]:checked\"))\n          .filter(Boolean)\n          .forEach(item => item.click());\n        return;\n      }\n      case \"delete_unfinished\":\n      case \"delete_completed\": {\n        const nodes = fullTodoList\n          .filter(\n            item =>\n              !!item.querySelector(\n                `input[type=checkbox]${\n                  action === \"delete_unfinished\" ? \":not(:checked)\" : \":checked\"\n                }`\n              )\n          )\n          .reverse() // If we don't delete in reverse, prosemirror removes nodes\n          .forEach(item => {\n            if (!item.parentNode) return;\n\n            const pos = view.posAtDOM(item);\n            const n = view.state.doc.nodeAt(pos);\n            const tr = view.state.tr.deleteRange(pos - 2, pos + n.nodeSize);\n            view.dispatch(tr);\n          });\n      }\n      case \"copy\": {\n        return;\n      }\n      default:\n        return;\n    }\n  });\n  return dom;\n};\n\nexport const DurationWidget = (match, view, getPos) => {\n  const dom = document.createElement(\"span\");\n  dom.classList.add(\"duration--menu\");\n  dom.innerHTML = `\n        <button class=\"duration--menu--trigger\">▼</button>\n        <div class=\"duration--menu--options\">\n          <button data-action=\"play\">Play</button>\n          <button data-action=\"start\">Continue</button>\n          <button data-action=\"double\">Double</button>\n        </div>\n      `;\n\n  dom.addEventListener(\"click\", e => {\n    switch (e.target.dataset.action) {\n      case \"start\": {\n        const d = parseDurationMatch(match);\n        const popupProps = {\n          centered: true,\n          actions: [\n            {\n              text: \"Stop\",\n              fn: hidePopup\n            }\n          ]\n        };\n        let interval = setInterval(() => {\n          d.s += 1;\n          normalizeDuration(d);\n          showPopup({ content: durationToStr(d), ...popupProps });\n        }, 1000);\n\n        const prevText = durationToStr(d);\n        showPopup({\n          ...popupProps,\n          content: durationToStr(d),\n          onHide: () => {\n            clearInterval(interval);\n            view.dispatch(\n              view.state.tr.insertText(\n                durationToStr(d),\n                getPos(),\n                getPos() + prevText.length\n              )\n            );\n          }\n        });\n        return;\n      }\n      case \"double\": {\n        const m = parseDurationMatch(match);\n\n        Object.keys(m).forEach(k => {\n          m[k] = m[k] * 2;\n        });\n\n        normalizeDuration(m);\n\n        const text = durationToStr(m);\n        view.dispatch(\n          view.state.tr.insertText(text, getPos(), getPos() + match[0].length)\n        );\n        return;\n      }\n\n      case \"play\": {\n        const target = durationToStr(parseDurationMatch(match));\n        const d = parseDurationMatch([]);\n        const popupProps = {\n          centered: true,\n          actions: [\n            {\n              text: \"Stop\",\n              fn: hidePopup\n            }\n          ]\n        };\n        let interval = setInterval(() => {\n          d.s += 1;\n          normalizeDuration(d);\n          const current = durationToStr(d);\n          showPopup({\n            content: `${current}/${target}`,\n            ...popupProps\n          });\n\n          if (current === target) {\n            clearInterval(interval);\n            showPopup({\n              ...popupProps,\n              content: `${current}/${target}`,\n              actions: [\n                {\n                  text: \"End\",\n                  fn: hidePopup\n                }\n              ]\n            });\n          }\n        }, 1000);\n\n        const prevText = durationToStr(d);\n        showPopup({\n          ...popupProps,\n          content: durationToStr(d),\n          onHide: () => {\n            clearInterval(interval);\n            // view.dispatch(\n            //   view.state.tr.insertText(\n            //     durationToStr(d),\n            //     getPos(),\n            //     getPos() + prevText.length\n            //   )\n            // );\n          }\n        });\n        return;\n      }\n      default:\n    }\n  });\n  return dom;\n};\n","import Pikaday from \"pikaday\";\nimport hljs from \"highlight.js\";\n\nimport { Plugin } from \"prosemirror-state\";\nimport { Decoration, DecorationSet } from \"prosemirror-view\";\nimport { formatDate } from \"./util\";\nimport { TODOIndicator, DurationWidget } from \"./indicators\";\n\nimport \"pikaday/css/pikaday.css\";\nimport \"highlight.js/styles/arta.css\";\n\n/**\n * Decorations that require the same open and close strings\n * and capture all the lines in between.\n *\n * NOTE: These work on the wrapper node, not on the text node.\n *\n */\nexport const OpenCloseDecorations = {\n  code: /^```/gi\n};\n\nexport const WholeNodeDecorations = {\n  // NOTE: Table row is also handled repeatably.\n  tableRow: /^\\|(?:\\s|\\-|=).*$/gi,\n  _heading: /^(#{1,5})\\s.*$/gi // Underscored names are skipped.\n};\n\nexport const RepeatableDecorations = {\n  quote: /^>\\s/gi,\n  bullet: /^\\*\\s/gi,\n  ordered: /^\\d+\\.\\s/gi,\n  todo: /^(\\-|\\+)\\s/gi\n};\n\n/**\n * These work on the text node.\n */\nexport const Decorations = {\n  bold: /\\*\\w[\\w\\s]*\\w\\*/gi,\n  italic: /\\/\\w[\\w\\s]*\\w\\//gi,\n  highlight: /(\\`[^\\`]+\\`)|important|now|TODO:|NOTE:/gi,\n  underline: /\\_[^\\_\\s]+\\_/gi,\n  striketrough: /\\~[^\\~\\s]+\\~/gi,\n  tag: /#[^\\b\\s#]+/gi,\n  hr: /^\\-\\-\\-$/gi,\n  url: /https?:\\/\\/[a-z0-9\\.]+/gi,\n  explication: /\\([^\\)]+\\)/gi,\n\n  date: /\\b(\\d\\d\\d\\d)-(\\d\\d)-(\\d\\d)(:?\\s(\\d\\d):(\\d\\d))?\\b/gi,\n  duration: /\\b(\\d\\d?[hms])(\\d\\d?[ms])?(\\d\\d?s)?\\b/gi,\n\n  // NOTE: If name starts with `_`, standard decoration won't be\n  // created. This can be used if we some special handling in\n  // with DecorationsWidgets function.\n  _counter: /\\[(\\d+)\\]/gi,\n  _checkbox: /\\[(\\+|\\-)\\]\\s/gi,\n  _proportion: /\\[(\\d+)\\/(\\d+)\\]/gi,\n\n  ...RepeatableDecorations\n};\n\n/**\n * Some decorations require additional widgets.\n */\nexport const DecorationsWidgets = {\n  todo: getTodoWidgets,\n  duration: getDurationWidgets,\n  date: getDateWidgets,\n  _checkbox: getCheckboxWidgets,\n  _counter: getCounterWidgets,\n  _proportion: getCounterWidgets,\n  _heading: getHeadingWidgets\n};\n\n/**\n * Decoration won't be visible inside specified nodes.\n */\nconst excludedNodes = {};\n\n/**\n * We don't want some decorations in table rows.\n */\nconst excludedInTableRow = {\n  _counter: true,\n  _checkbox: true,\n  _proportion: true,\n  date: true,\n  duration: true\n};\n\nfunction getDecorations(doc) {\n  let decos = [];\n  let openClose = {};\n\n  doc.descendants((node, pos) => {\n    if (excludedNodes[doc.resolve(pos).node().type.name]) return;\n\n    if (node.isText) {\n      const isTableRow = !!node.text.match(WholeNodeDecorations[\"tableRow\"]);\n      Object.keys(Decorations).forEach(name => {\n        const regex = Decorations[name];\n        while (true) {\n          let m = regex.exec(node.text);\n          if (!m) return;\n\n          if (excludedInTableRow[name] && isTableRow) {\n            return;\n          }\n\n          if (name[0] !== \"_\") {\n            decos.push(\n              Decoration.inline(pos + m.index, pos + m.index + m[0].length, {\n                class: name,\n\n                ...(name === \"url\"\n                  ? {\n                      nodeName: \"a\",\n                      href: node.text,\n                      title: node.text\n                    }\n                  : {})\n              })\n            );\n          }\n\n          if (DecorationsWidgets[name]) {\n            decos.push(...DecorationsWidgets[name](m, pos, doc, node));\n          }\n        }\n      });\n\n      return;\n    }\n\n    Object.keys(WholeNodeDecorations).forEach(name => {\n      const regex = WholeNodeDecorations[name];\n      while (true) {\n        let m = regex.exec(node.textContent);\n        if (!m) return;\n\n        if (name[0] !== \"_\") {\n          decos.push(\n            Decoration.node(pos + m.index, pos + m.index + node.nodeSize, {\n              class: name\n            })\n          );\n        }\n\n        if (DecorationsWidgets[name]) {\n          decos.push(...DecorationsWidgets[name](m, pos, doc, node));\n        }\n      }\n    });\n\n    Object.keys(OpenCloseDecorations).forEach(name => {\n      const regex = OpenCloseDecorations[name];\n      while (true) {\n        let m = regex.exec(node.textContent);\n        if (!m) return;\n\n        if (!openClose[name]) {\n          openClose[name] = { node, pos };\n          continue;\n        }\n\n        if (openClose[name]) {\n          const closing = { node, pos };\n          const opening = openClose[name];\n\n          const textContent = [];\n          doc.nodesBetween(opening.pos, closing.pos + 1, (n, p) => {\n            if (n.isText) return;\n            textContent.push(n.textContent);\n\n            decos.push(\n              Decoration.node(p, p + n.nodeSize, {\n                class: name\n              })\n            );\n          });\n\n          delete openClose[name];\n\n          decos.push(\n            Decoration.widget(\n              opening.pos + 1,\n              (view, getPos) => {\n                const dom = document.createElement(\"pre\");\n                const lang = textContent[0].replace(\"```\", \"\");\n                const source = hljs.getLanguage(lang)\n                  ? hljs.highlight(lang, textContent.slice(1, -1).join(\"\\n\"))\n                      .value\n                  : textContent.slice(1, -1).join(\"\\n\");\n                dom.innerHTML = `${textContent[0]}\\n${source}\\n${\n                  textContent[textContent.length - 1]\n                }`;\n\n                dom.classList.add(\"code-highlight\");\n\n                return dom;\n              },\n              {\n                key: textContent.join(\"\\n\")\n              }\n            )\n          );\n          continue;\n        }\n      }\n    });\n  });\n\n  return DecorationSet.create(doc, decos);\n}\n\n// =============================================================================\n// Widgets\n\nfunction getTodoWidgets(m, pos, doc) {\n  const decos = [];\n  const currentNode = doc.resolve(pos).node();\n  const nodeBefore = doc.resolve(pos - 1).nodeBefore;\n  const nodeAfter = doc.resolve(pos + currentNode.nodeSize).node();\n\n  decos.push(\n    Decoration.widget(\n      pos + m.index,\n      (view, getPos) => {\n        const dom = document.createElement(\"input\");\n        dom.style.zIndex = 2;\n        dom.style.position = \"relative\";\n        dom.type = \"checkbox\";\n        dom.checked = m[1] === \"+\";\n        dom.addEventListener(\"click\", e => {\n          view.dispatch(\n            view.state.tr.insertText(\n              m[1] === \"+\" ? \"-\" : \"+\",\n              getPos(),\n              getPos() + 1\n            )\n          );\n        });\n        return dom;\n      },\n      {\n        key: m[0]\n      }\n    )\n  );\n\n  if (\n    (!nodeBefore || !/(\\+|\\-)\\s/.test(nodeBefore.textContent.slice(0, 2))) &&\n    nodeAfter &&\n    /(\\+|\\-)\\s/.test(nodeAfter.textContent.slice(0, 2))\n  ) {\n    decos.push(\n      // TODO: cache\n      Decoration.widget(pos + m.index, view => TODOIndicator(view), {\n        key: currentNode.textContent\n      })\n    );\n  }\n\n  return decos;\n}\n\nfunction getDurationWidgets(m, pos) {\n  return [\n    Decoration.widget(\n      pos + m.index,\n      (view, getPos) => DurationWidget(m, view, getPos),\n      {\n        key: m[0]\n      }\n    )\n  ];\n}\n\nfunction getDateWidgets(m, pos) {\n  return [\n    Decoration.widget(\n      pos + m.index,\n      (view, getPos) => {\n        const dom = document.createElement(\"span\");\n        dom.classList.add(\"date--menu\");\n        dom.innerHTML = `\n          <button class=\"date--menu--trigger\">▼</button>\n        `;\n\n        const input = document.createElement(\"input\");\n        const currentDate = new Date(Date.parse(m[0]));\n        input.value = formatDate(currentDate);\n\n        // TODO: https://github.com/fengyuanchen/pickerjs\n        const picker = new Pikaday({\n          field: input,\n          trigger: dom.querySelector(\"button.date--menu--trigger\"),\n          firstDay: 1,\n          defaultDate: currentDate,\n          onSelect: function() {\n            debugger;\n            view.dispatch(\n              view.state.tr.insertText(\n                formatDate(this.getDate()),\n                getPos(),\n                getPos() + m[0].length\n              )\n            );\n          }\n        });\n\n        return dom;\n      },\n      {\n        key: m[0]\n      }\n    )\n  ];\n}\n\nfunction getCheckboxWidgets(m, pos) {\n  return [\n    Decoration.inline(pos + m.index, pos + m.index + m[0].length - 1, {\n      class: \"checkbox\",\n      contenteditable: false\n    }),\n    Decoration.widget(\n      pos + m.index,\n      (view, getPos) => {\n        const dom = document.createElement(\"input\");\n        dom.style.zIndex = 2;\n        dom.style.position = \"relative\";\n        dom.type = \"checkbox\";\n        dom.checked = m[1] === \"+\";\n        dom.addEventListener(\"click\", e => {\n          view.dispatch(\n            view.state.tr.insertText(\n              m[1] === \"+\" ? \"-\" : \"+\",\n              getPos() + 1,\n              getPos() + 2\n            )\n          );\n        });\n        return dom;\n      },\n      {\n        key: m[0]\n      }\n    )\n  ];\n}\n\nfunction getCounterWidgets(m, pos) {\n  return [\n    Decoration.inline(pos + m.index, pos + m.index + 1, {\n      class: \"counter--hidden\"\n    }),\n    Decoration.widget(\n      pos + m.index,\n      (view, getPos) => {\n        const dom = document.createElement(\"button\");\n        dom.className = \"counter--left\";\n        dom.innerHTML = \"-\";\n\n        dom.addEventListener(\"mousedown\", e => {\n          e.preventDefault();\n          e.stopPropagation();\n        });\n        dom.addEventListener(\"click\", e => {\n          e.stopPropagation();\n          e.preventDefault();\n          view.dispatch(\n            view.state.tr.insertText(\n              `[${Math.max(m[1] * 1 - 1, 0)}${m[2] ? `/${m[2]}` : \"\"}]`,\n              getPos(),\n              getPos() + m[0].length\n            )\n          );\n        });\n        return dom;\n      },\n      {\n        key: m[0]\n      }\n    ),\n    Decoration.inline(pos + m.index + 1, pos + m.index + m[0].length - 1, {\n      class: \"counter\"\n    }),\n    Decoration.inline(\n      pos + m.index + m[0].length - 1,\n      pos + m.index + m[0].length,\n      {\n        class: \"counter--hidden right\"\n      }\n    ),\n    Decoration.widget(\n      pos + m.index + m[0].length - 1,\n      (view, getPos) => {\n        const dom = document.createElement(\"button\");\n        dom.className = \"counter--right\";\n        dom.innerHTML = \"+\";\n\n        dom.addEventListener(\"mousedown\", e => {\n          e.preventDefault();\n          e.stopPropagation();\n        });\n\n        dom.addEventListener(\"click\", e => {\n          e.preventDefault();\n          view.dispatch(\n            view.state.tr.insertText(\n              `[${Math.min(m[1] * 1 + 1, m[2] ? m[2] : Infinity)}${\n                m[2] ? `/${m[2]}` : \"\"\n              }]`,\n              getPos() - m[0].length + 1,\n              getPos() + 1\n            )\n          );\n        });\n        return dom;\n      },\n      {\n        key: m[0]\n      }\n    )\n  ];\n}\n\nfunction getHeadingWidgets(m, pos, _, node) {\n  return [\n    Decoration.node(pos + m.index, pos + m.index + node.nodeSize, {\n      class: \"heading\",\n      nodeName: `h${m[1].length}`\n    }),\n    Decoration.inline(pos + m.index + 1, pos + m.index + 1 + m[1].length, {\n      class: \"heading--hidden\",\n      contenteditable: false\n    }),\n    Decoration.widget(\n      pos + m.index + 1,\n      (view, getPos) => {\n        const dom = document.createElement(\"div\");\n        dom.classList.add(\"indicator\");\n        dom.innerHTML = `H${m[1].length}`;\n\n        dom.addEventListener(\"click\", e => {\n          e.preventDefault();\n          view.dispatch(\n            view.state.tr.insertText(\n              m[1].length === 5 ? \"#\" : `${m[1]}#`,\n              getPos(),\n              getPos() + m[1].length\n            )\n          );\n        });\n        return dom;\n      },\n      {\n        key: m[0]\n      }\n    )\n  ];\n}\n\n// =============================================================================\n// Plugin\n\nexport default new Plugin({\n  state: {\n    init(_, { doc }) {\n      return getDecorations(doc);\n    },\n    apply(tr, decorationsSet) {\n      return tr.docChanged ? getDecorations(tr.doc) : decorationsSet;\n\n      // TODO: Always recalculate open close decorations.\n      // TODO: Cache nodes for widgets.\n      //\n      // if (!tr.docChanged) return decorationsSet;\n      // const set = decorationsSet.map(tr.mapping, tr.doc);\n      // tr.mapping.maps.forEach(m => {\n      //   const { ranges } = m;\n      //   const from = ranges[0];\n      //   const to = Math.max(ranges[1], ranges[2]);\n      //\n      //   const touchedDecorations = set.find(from, to);\n      //   set.remove(touchedDecorations);\n      //   tr.doc.nodesBetween(from, to, (node, pos) => {\n      //     // TODO: create decoratoins\n      //   });\n      // });\n      //\n      // return set;\n    }\n  },\n  props: {\n    decorations(state) {\n      return this.getState(state);\n    }\n  }\n});\n","import {\n  joinPoint,\n  canJoin,\n  findWrapping,\n  liftTarget,\n  canSplit,\n  ReplaceAroundStep\n} from \"prosemirror-transform\";\nimport { Slice, Fragment } from \"prosemirror-model\";\nimport {\n  Selection,\n  TextSelection,\n  NodeSelection,\n  AllSelection,\n  SelectionRange\n} from \"prosemirror-state\";\n\nimport { RepeatableDecorations, WholeNodeDecorations } from \"./decorations\";\n\n// =============================================================================\n// Lists repeating\n\nexport function splitBlockWithDecorations(state, dispatch) {\n  let { $from, $to } = state.selection;\n  if (\n    state.selection instanceof NodeSelection &&\n    state.selection.node.isBlock\n  ) {\n    if (!$from.parentOffset || !canSplit(state.doc, $from.pos)) return false;\n    if (dispatch) dispatch(state.tr.split($from.pos).scrollIntoView());\n    return true;\n  }\n\n  if (!$from.parent.isBlock) return false;\n\n  if (dispatch) {\n    let atEnd = $to.parentOffset == $to.parent.content.size;\n    let tr = state.tr;\n    if (state.selection instanceof TextSelection) tr.deleteSelection();\n    let deflt =\n      $from.depth == 0\n        ? null\n        : $from.node(-1).contentMatchAt($from.indexAfter(-1)).defaultType;\n    let types = atEnd && deflt ? [{ type: deflt }] : null;\n    let can = canSplit(tr.doc, tr.mapping.map($from.pos), 1, types);\n    if (\n      !types &&\n      !can &&\n      canSplit(tr.doc, tr.mapping.map($from.pos), 1, deflt && [{ type: deflt }])\n    ) {\n      types = [{ type: deflt }];\n      can = true;\n    }\n    if (can) {\n      tr.split(tr.mapping.map($from.pos), 1, types);\n      if (\n        !atEnd &&\n        !$from.parentOffset &&\n        $from.parent.type != deflt &&\n        $from\n          .node(-1)\n          .canReplace(\n            $from.index(-1),\n            $from.indexAfter(-1),\n            Fragment.from(deflt.create(), $from.parent)\n          )\n      )\n        tr.setNodeMarkup(tr.mapping.map($from.before()), deflt);\n    }\n\n    const { textContent } = $from.parent;\n    Object.values(RepeatableDecorations).forEach(d => {\n      let match;\n      if (!(match = textContent.match(d))) {\n        return;\n      }\n\n      if (match[0] === textContent) {\n        tr.delete($from.pos - 2, $from.pos + 2);\n      } else {\n        let text = match[0];\n        if (match[0] == \"+ \") {\n          text = \"- \";\n        } else if (RepeatableDecorations.ordered.test(match[0])) {\n          text = `${match[0][0] * 1 + 1}${match[0].slice(1)}`;\n        }\n\n        tr.insertText(text.replace(\" \", `\\xa0`));\n      }\n    });\n\n    if (WholeNodeDecorations.tableRow.test(textContent)) {\n      tr.insertText(\"| \".replace(\" \", `\\xa0`));\n    }\n\n    dispatch(tr.scrollIntoView());\n  }\n  return true;\n}\n\n// =============================================================================\n// Tables\n\nexport function formatTable(state, dispatch, view) {\n  const { $from, to } = state.selection;\n  const same = $from.sharedDepth(to);\n  if (same == 0) return false;\n\n  const proseNode = $from.before(same);\n  const currentNode = view.nodeDOM(proseNode);\n  const domNodes = [currentNode];\n\n  if (!currentNode.classList.contains(\"tableRow\")) return false;\n\n  let next = currentNode;\n  while (\n    (next = next.nextElementSibling) &&\n    next.classList.contains(\"tableRow\")\n  ) {\n    domNodes.push(next);\n  }\n\n  let prev = currentNode;\n  while (\n    (prev = prev.previousElementSibling) &&\n    prev.classList.contains(\"tableRow\")\n  ) {\n    domNodes.unshift(prev);\n  }\n\n  const rows = domNodes.map(n => n.innerText);\n\n  const [result, nextSelectedRow, nextSelectedCell] = getFormattedTable(\n    rows,\n    domNodes.indexOf(currentNode),\n    $from.pos - proseNode - 1\n  );\n\n  domNodes.forEach((node, i) => {\n    const text = result[i].replace(new RegExp(\" \", \"g\"), `\\u00a0`);\n    const pos = view.posAtDOM(node);\n    const n = view.state.doc.nodeAt(pos);\n\n    const tr = view.state.tr.insertText(text, pos, pos + n.nodeSize);\n    if (i === nextSelectedRow) {\n      let posInCell = text\n        .split(\"|\")\n        .slice(0, nextSelectedCell + 2)\n        .join(\"|\")\n        .trim().length;\n\n      if (posInCell === 1) {\n        // Give some space if it is first empty cell.\n        posInCell = 2;\n      }\n\n      tr.setSelection(\n        TextSelection.create(tr.doc, pos + posInCell, pos + posInCell - 2)\n      );\n    }\n\n    dispatch(tr);\n  });\n}\n\nfunction getFormattedTable(rows, selectedRow, selectedChar) {\n  const isLineRow = row => row.slice(0, 2) === \"|-\";\n\n  const dataRows = rows\n    .filter(row => !isLineRow(row))\n    .map(row =>\n      row\n        .replace(/\\s\\s*/g, \" \")\n        .trim()\n        .split(\"|\")\n    );\n\n  const separatorRowsIdxs = rows\n    .map((row, i) => (isLineRow(row) ? i : null))\n    .filter(index => index !== null);\n\n  const maxCellsNum = Math.max(...dataRows.map(r => r.length));\n  const table = dataRows.map(row => {\n    const extraEmptyCells = \" \".repeat(maxCellsNum - row.length).split(\" \");\n    return [...row, ...extraEmptyCells];\n  });\n\n  for (let i = 0; i < maxCellsNum; i++) {\n    const maxWidth = Math.max(...table.map(row => row[i].length));\n    table.forEach(row => (row[i] = padBothToLength(row[i], maxWidth, \" \")));\n  }\n\n  const outputTable = table.map(\n    row => `| ${row.filter((c, i) => c !== \"\").join(\" | \")} |`\n  );\n\n  const lineRow = [...outputTable[0]].map(c => (c !== \"|\" ? \"-\" : c)).join(\"\");\n  separatorRowsIdxs.forEach(index => {\n    outputTable.splice(index, 0, lineRow);\n  });\n\n  const selectedCell =\n    rows[selectedRow].slice(0, selectedChar).split(\"|\").length - 2;\n  const resultCellsLength = outputTable[0].split(\"|\").length - 2;\n\n  let nextSelectedRow = selectedRow;\n  let nextSelectedCell = selectedCell + 1;\n\n  if (nextSelectedCell === resultCellsLength) {\n    nextSelectedCell = 0;\n    do {\n      nextSelectedRow += 1;\n    } while (separatorRowsIdxs.includes(nextSelectedRow));\n\n    if (!outputTable[nextSelectedRow]) {\n      nextSelectedRow = 0;\n    }\n  }\n\n  return [outputTable, nextSelectedRow, nextSelectedCell];\n}\n\nfunction padBothToLength(str, toLength, padStr = \" \") {\n  const fromLength = str.length;\n  const fromStart = Math.floor((toLength - fromLength) / 2);\n  const fromEnd = Math.ceil((toLength - fromLength) / 2);\n\n  return `${padStr.repeat(fromStart)}${str}${padStr.repeat(fromEnd)}`;\n}\n\n// =============================================================================\n// Headers navigation\n\nfunction selectHeader(prop, state, dispatch, view) {\n  const { $from, to } = state.selection;\n  const same = $from.sharedDepth(to);\n  if (same == 0) return false;\n\n  const proseNode = $from.before(same);\n  let currentNode = view.nodeDOM(proseNode);\n\n  while (!currentNode.parentNode.classList.contains(\"ProseMirror\")) {\n    currentNode = currentNode.parentNode;\n  }\n\n  let next = currentNode;\n  while ((next = next[prop])) {\n    if (next.classList.contains(\"heading\")) {\n      next.scrollIntoView({\n        block: \"start\",\n        inline: \"nearest\",\n        behavior: \"smooth\"\n      });\n      const pos = view.posAtDOM(next);\n      dispatch(\n        view.state.tr.setSelection(\n          Selection.near(view.state.doc.resolve(pos + next.tagName[1] * 1))\n        )\n      );\n      return true;\n    }\n  }\n}\n\nexport function selectNextHeader(...args) {\n  return selectHeader(\"nextElementSibling\", ...args);\n}\n\nexport function selectPrevHeader(...args) {\n  return selectHeader(\"previousElementSibling\", ...args);\n}\n","import chrono from \"chrono-node\";\n\nimport { Schema, Fragment } from \"prosemirror-model\";\nimport { ReplaceStep, ReplaceAroundStep, join } from \"prosemirror-transform\";\nimport { Plugin, NodeSelection, Selection } from \"prosemirror-state\";\n\nimport { keymap } from \"prosemirror-keymap\";\nimport { gapCursor } from \"prosemirror-gapcursor\";\nimport { dropCursor } from \"prosemirror-dropcursor\";\nimport { history, undo, redo } from \"prosemirror-history\";\nimport {\n  chainCommands,\n  selectParentNode,\n  baseKeymap\n} from \"prosemirror-commands\";\n\nimport { InputRule, inputRules } from \"prosemirror-inputrules\";\n\nimport decorations from \"./decorations\";\nimport {\n  formatDate,\n  getZeroBasedNum,\n  getDaysInMonthByWeeks,\n  monthNumToName\n} from \"./util\";\nimport {\n  splitBlockWithDecorations,\n  selectNextHeader,\n  selectPrevHeader,\n  formatTable\n} from \"./commands\";\n\n// =============================================================================\n// Schema\n\nexport const schema = new Schema({\n  nodes: {\n    doc: {\n      content: \"block+\"\n    },\n\n    paragraph: {\n      content: \"inline*\",\n      group: \"block\",\n      parseDOM: [{ tag: \"p\" }],\n      toDOM() {\n        return [\"p\", 0];\n      }\n    },\n\n    text: {\n      group: \"inline\",\n      toDOM(node) {\n        return node.text;\n      }\n    },\n\n    hard_break: {\n      inline: true,\n      group: \"inline\",\n      selectable: false,\n      parseDOM: [{ tag: \"br\" }],\n      toDOM: () => [\"br\"]\n    }\n  }\n});\n\n// =============================================================================\n// Plugins\n\nconst INPUT_RULES = (function() {\n  let rules = [\n    new InputRule(/<calendar:?(\\s\\d\\d\\d\\d-\\d\\d?)?>/, function(\n      state,\n      match,\n      start,\n      end\n    ) {\n      const { paragraph } = state.schema.nodes;\n      const today = match[1] ? new Date(...match[1].split(\"-\"), 0) : new Date();\n\n      const nodes = Fragment.from([\n        paragraph.create(\n          null,\n          schema.text(\n            `*${monthNumToName[today.getMonth()]} ${today.getFullYear()}*`\n          )\n        ),\n        paragraph.create(\n          null,\n          schema.text(\n            \"|---------|---------|---------|---------|---------|---------|---------|\"\n          )\n        ),\n        paragraph.create(\n          null,\n          schema.text(\n            \"|  *Mon*  |  *Tue*  |  *Wed*  |  *Thu*  |  *Fri*  |  *Sat*  |  *Sun*  |\"\n          )\n        ),\n        paragraph.create(\n          null,\n          schema.text(\n            \"|---------|---------|---------|---------|---------|---------|---------|\"\n          )\n        ),\n        ...getDaysInMonthByWeeks(\n          today.getMonth(),\n          today.getFullYear()\n        ).map(week =>\n          paragraph.create(\n            null,\n            state.schema.text(\n              \"| \" +\n                week\n                  .map(d =>\n                    d ? `   ${getZeroBasedNum(d.getDate())}   ` : \"        \"\n                  )\n                  .join(\"| \") +\n                \"|\"\n            )\n          )\n        ),\n        paragraph.create(\n          null,\n          schema.text(\n            \"|---------|---------|---------|---------|---------|---------|---------|\"\n          )\n        )\n      ]);\n\n      return state.tr.replaceWith(start, end, nodes);\n    }),\n    new InputRule(/<[^>]+>/, function(state, match, start, end) {\n      const parsed = chrono.parse(match[0])[0];\n      if (!parsed || parsed.index !== 1) {\n        return null;\n      }\n\n      let insert = chrono.parseDate(match[0]);\n      insert = formatDate(insert);\n\n      return state.tr.insertText(insert, start, end);\n    })\n  ];\n\n  return inputRules({ rules });\n})();\n\n// =============================================================================\n// Plugins\n\nexport const plugins = [\n  INPUT_RULES,\n\n  history(),\n  dropCursor(),\n  gapCursor(),\n\n  keymap({\n    \"Mod-z\": undo,\n    \"Shift-Mod-z\": redo,\n    \"Mod-i\": selectParentNode, // TODO: use it to kill row\n\n    \"Shift-Enter\": baseKeymap[\"Enter\"],\n    \"Ctrl-Enter\": baseKeymap[\"Enter\"], // TODO: add table row\n    // Ctrl-l -> clone line\n\n    Tab: formatTable,\n    Enter: splitBlockWithDecorations,\n    ...(/Mac/.test(navigator.platform)\n      ? {\n          \"Mod-Enter\": baseKeymap[\"Enter\"],\n          \"Mod-ArrowDown\": selectNextHeader,\n          \"Mod-ArrowUp\": selectPrevHeader\n        }\n      : {\n          \"Ctrl-y\": redo,\n          \"Ctrl-ArrowDown\": selectNextHeader,\n          \"Ctrl-ArrowUp\": selectPrevHeader\n        })\n  }),\n  keymap(baseKeymap),\n\n  decorations\n];\n","import React from \"react\";\nimport { EditorView } from \"prosemirror-view\";\nimport { EditorState } from \"prosemirror-state\";\n\n// import PropTypes from \"prop-types\";\n// static propTypes = {\n//   note: PropTypes.arrayOf(\n//     PropTypes.shape({\n//       id: PropTypes.number.isRequired,\n//       content: PropTypes.oneOfType([PropTypes.object, null]).isRequired,\n//       meta: PropTypes.shape({\n//         title: PropTypes.string.isRequired,\n//         tags: PropTypes.arrayOf(PropTypes.string).isRequired\n//       }).isRequired,\n//       created_at: PropTypes.instanceOf(Date).isRequired,\n//       updated_at: PropTypes.instanceOf(Date).isRequired,\n//       deleted_at: PropTypes.oneOfType([PropTypes.instanceOf(Date), null])\n//         .isRequired\n//     }).isRequired\n//   ),\n//   updateNote: PropTypes.func.isRequired\n// };\n\nimport Agenda from \"./Agenda\";\nimport Stats from \"./Stats\";\nimport CheatSheet from \"../CheatSheet/CheatSheet\";\n\nimport store from \"../Storage\";\n\nimport { schema, plugins } from \"./setup\";\nimport { isToday, formatDate } from \"./util\";\n\nimport \"./Editor.css\";\n\nclass Editor extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.elm = null;\n\n    this._editorView = null;\n    this._editorState = null;\n\n    this.note = store.getSelectedNote();\n    this.unsubscribe = store.subscribe(() => {\n      const selected = store.getSelectedNote();\n      if (this.note.id !== selected.id) {\n        this.note = selected;\n        this.forceUpdate();\n      }\n    });\n\n    this.state = {\n      helpShown: false,\n      agendaShown: false,\n      statsShown: false\n    };\n  }\n\n  showEditor = () => {\n    this.setState({\n      helpShown: false,\n      agendaShown: false,\n      statsShown: false\n    });\n  };\n  toggleHelp = () =>\n    this.setState({\n      helpShown: !this.state.helpShown,\n      agendaShown: false,\n      statsShown: false\n    });\n  toggleStats = () =>\n    this.setState({\n      statsShown: !this.state.statsShown,\n      helpShown: false,\n      agendaShown: false\n    });\n  toggleAgenda = () =>\n    this.setState({\n      agendaShown: !this.state.agendaShown,\n      helpShown: false,\n      statsShown: false\n    });\n\n  componentDidMount() {\n    document.addEventListener(\n      \"keydown\",\n      e => {\n        // Prevent default tab behavior.\n        if (e.keyCode === 9) {\n          e.preventDefault();\n          return;\n        }\n\n        // Allow clicking links when pressing control.\n        if (e.keyCode === 91) {\n          [...document.querySelectorAll(\"a\")].forEach(\n            a => (a.contentEditable = false)\n          );\n        }\n      },\n      false\n    );\n\n    document.addEventListener(\n      \"keyup\",\n      e => {\n        if (e.keyCode === 91) {\n          [...document.querySelectorAll(\"a\")].forEach(\n            a => (a.contentEditable = true)\n          );\n        }\n      },\n      false\n    );\n  }\n\n  componentWillUnmount() {\n    if (this._editorView) {\n      this._editorView.destroy();\n    }\n\n    this.unsubscribe();\n  }\n\n  _createEditorView = element => {\n    if (element != null) {\n      this.elm = element;\n      this._editorState = this.note.content\n        ? EditorState.fromJSON(\n            {\n              schema,\n              plugins\n            },\n            this.note.content\n          )\n        : EditorState.create({\n            schema,\n            plugins\n          });\n\n      this._editorView = new EditorView(element, {\n        state: this._editorState,\n        dispatchTransaction: tx => {\n          this._editorState = this._editorState.apply(tx);\n          this._editorView.updateState(this._editorState);\n\n          store.updateNote({\n            ...this.note,\n            content: this._editorState.toJSON(),\n            meta: {\n              title: this.getTitle(),\n              tags: this.getTags()\n            }\n          });\n        }\n      });\n    }\n  };\n\n  // ===========================================================================\n  // Commands\n\n  getTitle() {\n    const heading = this.elm && this.elm.querySelector(\".heading p\");\n    return heading\n      ? heading.lastChild.textContent.trim().replace(/#+/g, \"\")\n      : \"--\";\n  }\n\n  getTodos() {\n    return [...this.elm.querySelectorAll(\".todo\")]\n      .map(n => n.parentNode)\n      .map(n => {\n        const date = n.querySelector(\".date\");\n        const duration = n.querySelector(\".duration\");\n\n        const clone = n.cloneNode(true);\n        Array.from(clone.children)\n          .filter(c => c.classList.contains(\"ProseMirror-widget\"))\n          .forEach(c => c.parentNode.removeChild(c));\n\n        const remove = el => el && el.parentNode.removeChild(el);\n        remove(clone.querySelector(\".date\"));\n        remove(clone.querySelector(\".duration\"));\n\n        return {\n          text: clone.innerText.replace(/^(\\-|\\+)\\s/, \"\"),\n          date: date && date.innerText,\n          done: clone.innerText[0] === \"+\",\n          duration: duration && duration.innerText,\n          toggle: () => n.querySelector(\"input[type=checkbox]\").click()\n        };\n      });\n  }\n\n  getTags() {\n    const tags = this.elm && this.elm.querySelectorAll(\".tag\");\n    return tags ? [...tags].map(t => t.textContent.slice(1)) : [];\n  }\n\n  getSummary() {}\n\n  // ===========================================================================\n  // Handlers\n\n  // TODO: Example of commands for menu or something\n  onFocus() {\n    if (this._editorView) {\n      this._editorView.focus();\n    }\n  }\n\n  // ===========================================================================\n  // Rendering\n\n  renderHelp() {\n    return (\n      <div className=\"Editor--help\">\n        <CheatSheet />\n      </div>\n    );\n  }\n\n  renderMenu() {\n    const { statsShown, agendaShown, helpShown } = this.state;\n    const hideEdditor = statsShown || agendaShown || helpShown;\n    return (\n      <div className=\"Editor--menu\">\n        <button className={!hideEdditor && \"active\"} onClick={this.showEditor}>\n          Editor\n        </button>\n        <button className={agendaShown && \"active\"} onClick={this.toggleAgenda}>\n          Agenda\n        </button>\n        <button className={statsShown && \"active\"} onClick={this.toggleStats}>\n          Stats\n        </button>\n        <button className={helpShown && \"active\"} onClick={this.toggleHelp}>\n          Help\n        </button>\n      </div>\n    );\n  }\n\n  render() {\n    const { statsShown, agendaShown, helpShown } = this.state;\n    const hideEdditor = statsShown || agendaShown || helpShown;\n    return (\n      <div className=\"Editor\">\n        {this.renderMenu()}\n        {statsShown && <Stats todos={this.getTodos()} />}\n        {agendaShown && <Agenda todos={this.getTodos()} />}\n        {helpShown && this.renderHelp()}\n        <div\n          className=\"EditorWrapper\"\n          key={this.note.id}\n          ref={this._createEditorView}\n          style={hideEdditor ? { display: \"none\" } : {}}\n        />\n      </div>\n    );\n  }\n}\n\nexport default Editor;\n","import React, { Component } from \"react\";\n\nimport Menu from \"./Menu/Menu\";\nimport Editor from \"./Editor/Editor.js\";\n\nimport \"./App.css\";\n\nclass App extends Component {\n  render() {\n    return (\n      <>\n        <Menu />\n        <Editor />\n      </>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}